(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{288:function(t,s,a){"use strict";a.r(s);var n=a(19),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"将tushare中的数据导入到mysql中"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#将tushare中的数据导入到mysql中"}},[t._v("#")]),t._v(" 将tushare中的数据导入到mysql中")]),t._v(" "),a("p",[t._v("思路：")]),t._v(" "),a("ol",[a("li",[t._v("链接数据库")]),t._v(" "),a("li",[t._v("在 tushare 中查询数据")]),t._v(" "),a("li",[t._v("将数据存入数据库中")])]),t._v(" "),a("h2",{attrs:{id:"法一：pandas-sqlalchemy"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#法一：pandas-sqlalchemy"}},[t._v("#")]),t._v(" 法一：Pandas+SQLAlchemy")]),t._v(" "),a("div",{staticClass:"language-py extra-class"},[a("pre",{pre:!0,attrs:{class:"language-py"}},[a("code",[t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 导入必要模块")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" pandas "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" pd\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" sqlalchemy "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" create_engine\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 初始化数据库连接，使用mysqlclient模块")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 例：用户名：root, 密码:123456, 端口：3306,数据库：tushare")]),t._v("\nengine "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" create_engine"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'mysql://root:123456@localhost:3306/tushare'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查询语句，选出demo表中的所有数据")]),t._v("\nsql "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[t._v("'''\n      select * from demo;\n      '''")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# read_sql_query的两个参数: sql语句， 数据库连接")]),t._v("\ndf "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" pd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("read_sql_query"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" engine"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 输出employee表的查询结果")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("df"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 新建pandas中的DataFrame, 只有id,num两列")]),t._v("\ndf "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" pd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DataFrame"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'id'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'num'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("12")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("34")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("56")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("89")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 将新建的DataFrame储存为MySQL中的数据表，不储存index列")]),t._v("\ndf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("to_sql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'list'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" engine"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" index"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("False")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Read from and write to Mysql table successfully!'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[a("a",{attrs:{href:"https://segmentfault.com/a/1190000014210743",target:"_blank",rel:"noopener noreferrer"}},[t._v("🔗Python之使用Pandas库实现MySQL数据库的读写"),a("OutboundLink")],1)]),t._v(" "),a("h3",{attrs:{id:"存入乱码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#存入乱码"}},[t._v("#")]),t._v(" 存入乱码")]),t._v(" "),a("div",{staticClass:"language-text extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('engine = create_engine(str(r"mysql+mysqldb://%s:" + \'%s\' + "@%s/%s?charset=utf8") % (user, password, host, db))\n')])])]),a("h2",{attrs:{id:"法二：pymysql"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#法二：pymysql"}},[t._v("#")]),t._v(" 法二：pymysql")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/26495046",target:"_blank",rel:"noopener noreferrer"}},[t._v("🔗用Tushare下载所有股票数据"),a("OutboundLink")],1)]),t._v(" "),a("h2",{attrs:{id:"自动运行"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#自动运行"}},[t._v("#")]),t._v(" 自动运行")]),t._v(" "),a("p",[t._v("Q:如何定期自动更新？")]),t._v(" "),a("p",[t._v("A:你可以试试Windows的计划任务，定期运行Python的脚本即可，Python脚本运行的时候根据运行时间获取对应近一周/一月的数据，去重以后做持久化保存。")])])}),[],!1,null,null,null);s.default=e.exports}}]);